<ng-container *ngIf="ready; else loading">
  <app-header
    [title]="'Role Select'"
    [subtitle]="'To begin, please select a role.'"
  ></app-header>
  <app-body>
    <div class="row">
      <div class="col-md-6 my-3">
        <h3 class="text-center">
          Available Roles
        </h3>
        <div class="my-3">
          <app-card
            *ngIf="!hasJudgeName"
            [title]="'Judge'"
            [autoHeight]="false"
            [icon]="'fa-balance-scale'"
          >
            <p>
              The judge runs the case. Once all pieces of evidence are revealed,
              the judge rules a verdict. Just one player should have this role.
            </p>
            <app-modal-trigger-button
              [text]="'Become the Judge'"
              [boxId]="'judge'"
            >
            </app-modal-trigger-button>
          </app-card>
        </div>
        <div class="my-3" *ngIf="!hasPlaintiffName">
          <app-card
            [title]="'Plaintiff'"
            [autoHeight]="false"
            [icon]="'fa-user-circle-o'"
          >
            <p>
              The plaintiff reveals evidence and questions witnesses to accuse
              the defendant of something. Just one player should have this role.
            </p>
            <app-modal-trigger-button
              [text]="'Become the Plaintiff'"
              [boxId]="'plaintiff'"
            >
            </app-modal-trigger-button>
          </app-card>
        </div>
        <div class="my-3" *ngIf="!hasDefendantName">
          <app-card
            [title]="'Defendant'"
            [autoHeight]="false"
            [icon]="'fa-user-circle'"
          >
            <p>
              The defendant reveals evidence and questions witnesses to deny the
              plaintiff's accusation. Just one player should have this role.
            </p>
            <app-modal-trigger-button
              [text]="'Become the Defendant'"
              [boxId]="'defendant'"
            >
            </app-modal-trigger-button>
          </app-card>
        </div>
        <div class="my-3" *ngIf="allowWitnessJoin">
          <app-card
            [title]="'Witness'"
            [autoHeight]="false"
            [icon]="'fa-users'"
          >
            <p>
              The witnesses are called into court by the judge to connect their
              backstory to the case. Multiple players can have this role.
            </p>
            <app-modal-trigger-button
              [text]="'Become a Witness'"
              [boxId]="'witness'"
            >
            </app-modal-trigger-button>
          </app-card>
        </div>
        <div class="my-3">
          <app-card [title]="'Jury'" [autoHeight]="false" [icon]="'fa-eye'">
            <p>
              The jury spectates the case. Optionally, the judge may ask them
              for their opinion. Multiple players can have this role.
            </p>
            <button class="btn btn-primary" (click)="beJury()">
              Select
            </button>
          </app-card>
        </div>
        <div id="rejoin" *ngIf="showRejoin">
          <hr />
          <h3 class="text-center" *ngIf="showRejoin">
            Rejoin
          </h3>
          <div class="my-3">
            <app-card [autoHeight]="false">
              <button
                class="btn btn-outline-primary btn-block"
                (click)="returnJudge()"
                *ngIf="hasJudgeName"
              >
                <i class="fa fa-balance-scale"></i>
                Return as the Judge
              </button>
              <button
                class="btn btn-outline-primary btn-block"
                (click)="returnPlaintiff()"
                *ngIf="hasPlaintiffName"
              >
                <i class="fa fa-user-circle-o"></i>
                Return as the Plaintiff
              </button>
              <button
                class="btn btn-outline-primary btn-block"
                (click)="returnDefendant()"
                *ngIf="hasDefendantName"
              >
                <i class="fa fa-user-circle"></i>
                Return as the Defendant
              </button>
              <button
                class="btn btn-outline-primary btn-block"
                (click)="returnWitness()"
                *ngIf="hasAWitness"
              >
                <i class="fa fa-users"></i>
                Return as a Witness
              </button>
            </app-card>
          </div>
        </div>
      </div>
      <div class="col-md-6 my-3">
        <app-revelations [caseId]="case._id"></app-revelations>
      </div>
    </div>
  </app-body>
</ng-container>

<ng-template #loading>
  <app-body>
    <div class="row">
      <div class="col-md-12">
        <app-loading [message]="'Preparing role selection...'"></app-loading>
      </div>
    </div>
  </app-body>
</ng-template>

<ng-template #nameInput>
  <label>Your Name</label>
  <br />
  <br />
  <input type="text" name="playerName" [(ngModel)]="playerName" /><br /><br />
  <div class="alert alert-warning" *ngIf="!hasPlayerName">
    You must enter a name to continue.
  </div>
</ng-template>

<app-advanced-modal-box [boxId]="'judge'" [title]="'Judge'">
  <ng-container *ngTemplateOutlet="nameInput"></ng-container>
  <button
    data-dismiss="modal"
    class="btn btn-primary"
    (click)="beJudge()"
    [disabled]="!hasPlayerName"
  >
    Join
  </button>
</app-advanced-modal-box>

<app-advanced-modal-box [boxId]="'plaintiff'" [title]="'Plaintiff'">
  <ng-container *ngTemplateOutlet="nameInput"></ng-container>
  <button
    data-dismiss="modal"
    class="btn btn-primary"
    (click)="bePlaintiff()"
    [disabled]="!hasPlayerName"
  >
    Join
  </button>
</app-advanced-modal-box>

<app-advanced-modal-box [boxId]="'defendant'" [title]="'Defendant'">
  <ng-container *ngTemplateOutlet="nameInput"></ng-container>
  <button
    data-dismiss="modal"
    class="btn btn-primary"
    (click)="beDefendant()"
    [disabled]="!hasPlayerName"
  >
    Join
  </button>
</app-advanced-modal-box>

<app-advanced-modal-box [boxId]="'witness'" [title]="'Witness'">
  <ng-container *ngTemplateOutlet="nameInput"></ng-container>
  <button
    data-dismiss="modal"
    class="btn btn-primary"
    (click)="beWitness()"
    [disabled]="!hasPlayerName"
  >
    Join
  </button>
</app-advanced-modal-box>
